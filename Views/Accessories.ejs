<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/CSS/products.css">
    <title>Boomy's Accessories</title>
</head>

<body>
    <%- include("./Partials/NavUser.ejs") %>
        <%- include("./Partials/chat.ejs") %>

            <div class="container">
                <div class="text2">
                    <p>Category</p>
                    <h3>Accessories</h3>
                </div>
                <div class="filter">
                    <label for="sort">Sort by:</label>
                    <select id="sort" onchange="sortProducts(this.value)">
                <option value="default">Default</option>
                <option value="highToLow">Price: High to Low</option>
                <option value="lowToHigh">Price: Low to High</option>
            </select>
                </div>
                <% if (Product.length > 0) { %>
                    <% let i = 0; %>
                        <div class="row">
                            <% Product.forEach(pro => { %>
                                <% if (i % 3 === 0 && i !== 0) { %>
                        </div>
                        <div class="row">
                            <% } %>
                                <div class="column">
                                    <div>
                                        <a href="/product/<%= pro.id %>">
                                            <div class="images">
                                                <img src="/uploads/<%= pro.images[0] %>">
                                                <img src="/uploads/<%= pro.images[1] %>" class="imgtop">
                                            </div>
                                        </a>
                                        <div class="product-details">
                                            <h1 class="product-name">
                                                <%= pro.itemName %>
                                            </h1>
                                            <h2 class="product-price">
                                                <span class="before">EGP <%= pro.price_before %>.00</span>
                                                <span class="after">EGP <%= pro.price_after %>.00</span>
                                            </h2>
                                            <p class="product-discount">
                                                <%= pro.Sales %>% Discount</p>
                                            <span class="buttons">
                            <a class="add-to-cart-button" href="/cart/add/<%= pro._id %>">Add To Cart</a>
                            <a class="add-to-wishlist-button" href="/wishlist/add/<%= pro._id %>">Wishlist</a>
                            </span>
                                        </div>
                                    </div>
                                </div>
                                <% i++; %>
                                    <% }) %>
                        </div>
                        <% } else { %>
                            <p>There are no products to display...</p>
                            <% } %>
                                <div class="pagination">
                                    <a href="#" class="pagination-button" id="previous-button">Previous</a>
                                    <a href="#" class="pagination-button" id="next-button">Next</a>
                                </div>
            </div>

            <footer>
                <%- include("./Partials/footer.ejs") %>
            </footer>

            <script>
                function sortProducts(sortOption) {
                    let products = Array.from(document.querySelectorAll('.column'));
                    let container = document.querySelector('.row');

                    if (sortOption === 'highToLow') {
                        products.sort((a, b) => {
                            let priceA = parseInt(a.querySelector('.after').textContent.replace('EGP', ''));
                            let priceB = parseInt(b.querySelector('.after').textContent.replace('EGP', ''));
                            return priceB - priceA;
                        });
                    } else if (sortOption === 'lowToHigh') {
                        products.sort((a, b) => {
                            let priceA = parseInt(a.querySelector('.after').textContent.replace('EGP', ''));
                            let priceB = parseInt(b.querySelector('.after').textContent.replace('EGP', ''));
                            return priceA - priceB;
                        });
                    }

                    products.forEach(product => container.appendChild(product));
                }
                const products = Array.from(document.querySelectorAll('.column'));
                const previousButton = document.getElementById('previous-button');
                const nextButton = document.getElementById('next-button');

                // Set the number of products per page
                const productsPerPage = 6;

                // Set the initial page number to 1
                let currentPage = 1;

                // Calculate the number of pages based on the number of products and the products per page
                const totalPages = Math.ceil(products.length / productsPerPage);

                // Define a function to show the products for the current page
                function showProductsForPage(pageNumber) {
                    // Calculate the start and end index for the products on the current page
                    const startIndex = (pageNumber - 1) * productsPerPage;
                    const endIndex = startIndex + productsPerPage;

                    // Hide all products
                    products.forEach(product => product.style.display = 'none');

                    // Show the products for the current page
                    products.slice(startIndex, endIndex).forEach(product => product.style.display = 'block');
                }

                // Show the products for the initial page
                showProductsForPage(currentPage);

                // Add a click event listener to the previous button
                previousButton.addEventListener('click', () => {
                    // Decrement the current page number


                    // Disable the previous button if on the first page
                    if (currentPage === 1) {
                        previousButton.disabled = true;
                    } else {
                        currentPage--;
                    }

                    // Enable the next button
                    nextButton.disabled = false;


                    // Show the products for the new current page
                    showProductsForPage(currentPage);
                });

                // Add a click event listener to the next button
                nextButton.addEventListener('click', () => {
                    // Increment the current page number

                    // Disable the next button if on the last page
                    if (currentPage === totalPages) {
                        nextButton.disabled = true;
                    } else {
                        currentPage++;
                    }
                    // Enable the previous button
                    previousButton.disabled = false;



                    // Show the products for the new current page
                    showProductsForPage(currentPage);
                });

                // Disable the previous button if on the first page
                if (currentPage === 1) {
                    previousButton.disabled = true;
                }

                // Disable the next button if on the last page
                if (currentPage === totalPages) {
                    nextButton.disabled = true;
                }
            </script>
</body>

</html>